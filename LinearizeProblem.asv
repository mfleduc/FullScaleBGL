function [Sstar] = LinearizeProblem(Y,Phi, Sigma,Q) 
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
p = size(Q,1);

SiPhi = Sigma\Phi ;
projdata = Y'*SiPhi/sqrt(size(Y,2));

PhiSiPhi = Phi'*SiPhi ;

Mi = (Q+PhiSiPhi);
innerpart = Q+PhiSiPhi+projdata'*projdata;
% QpPsPi = inv((Q+PhiSiPhi));
% Sstar = ((Q+PhiSiPhi))\(innerpart/(Q+PhiSiPhi));
Sstar = Mi\(innerpart/Mi);
if any(isnan(Sstar(:)))
    keyboard
end
% Sstar = 0.5*(Sstar+Sstar');
end